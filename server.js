(()=>{"use strict";var e={723:(e,t,r)=>{r.r(t),r.d(t,{DOMINIO:()=>c,EMAIL_APP:()=>o,MONGO_URL:()=>a,PASSWORD_APP:()=>l,PORT:()=>n}),(0,require("dotenv").config)();var n=process.env.PORT,a=process.env.MONGO_URL,c=process.env.DOMINIO,o=process.env.EMAIL_APP,l=process.env.PASSWORD_APP},184:e=>{e.exports=require("nodemailer")},689:e=>{e.exports=require("react")}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,r),c.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=require("express");var t=r.n(e);const n=require("cors");var a=r.n(n),c=r(689),o=r.n(c);const l=require("react-router-dom/server"),s=require("react-dom/server"),i=require("morgan");var m=r.n(i);const u=require("@babel/runtime/helpers/asyncToGenerator");var d=r.n(u);const p=require("@babel/runtime/helpers/slicedToArray");var b=r.n(p);const v=require("@babel/runtime/regenerator");var f=r.n(v);const g=(0,c.createContext)(),E=require("@babel/runtime/helpers/defineProperty");var y=r.n(E);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const O=function(e,t){var r=t.payload;return"GET_PRODUCTS"===t.type?N(N({},e),{},{products:r}):e},x=require("axios");var P=r.n(x);const C=function(e){var t=e.children,r=(0,c.useReducer)(O,{products:[]}),n=b()(r,2),a=n[0],l=n[1],s=(0,c.useState)(""),i=b()(s,2),m=i[0],u=i[1],p=(0,c.useState)(""),v=b()(p,2),E=v[0],y=v[1],h=(0,c.useState)(""),N=b()(h,2),x=N[0],C=N[1],j=(0,c.useState)(1),S=b()(j,2),w=S[0],k=S[1],q=(0,c.useState)(""),A=b()(q,2),T=A[0],D=A[1];(0,c.useEffect)((function(){R(m,E,x,w,T)}),[m,E,x,w,T]);var R=function(){var e=d()(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()("/api/products?category=".concat(m,"&brand=").concat(E,"&title=").concat(x,"&page=").concat(w,"&sort=").concat(T)).then((function(e){l({type:"GET_PRODUCTS",payload:e.data})})).catch((function(e){console.log(e)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o().createElement(g.Provider,{value:{products:a.products,page:w,setCategory:u,setBrand:y,setTitle:C,setPage:k,setSort:D}},t)},j=require("react-router-dom"),S=require("react-use-cart"),w=function(e){var t=e.title,r=e.image,n=e.category,a=e.brand,c=e.price,l=e.stock,s=e.id,i=(0,S.useCart)(),m=i.addItem,u=i.totalItems;return o().createElement("div",{className:"col-6"},o().createElement("div",{className:"card mb-3 text-center h-100"},o().createElement("div",{className:"card-body"},o().createElement("img",{src:r,alt:t,className:"img-fluid img-thumbnail h-50"}),o().createElement("div",null,o().createElement("h5",{className:"card-title"},t),o().createElement("p",{className:"card-text"},"categoria: ",n),o().createElement("p",{className:"card-text"},"Marca: ",a),o().createElement("p",{className:"card-text"},"Cantidad: ",l))),o().createElement("div",{className:"d-grid gap-2 mx-auto d-md-block mb-3"},o().createElement("button",{type:"button",onClick:function(){return m({title:t,image:r,category:n,brand:a,price:c,stock:l,id:s})},className:"btn btn-outline-success mx-1"}," ",c,"$ Agregar al carrito"),o().createElement(j.Link,{to:"/payment"}," ",o().createElement("button",{type:"button",className:"btn btn-outline-success mx-1"},"Ir al carrito (",u,")")))))},k=function(){var e=(0,c.useContext)(g).products.products;return o().createElement("div",{className:"container"},o().createElement("div",{className:"row"},o().createElement("div",{className:"row row-cols-1 row-cols-md-3 g-4"},e&&e.map((function(e,t){return o().createElement(w,{key:t,title:e.title,category:e.category,brand:e.brand,image:e.image,price:e.price,stock:e.stock,id:e._id})})))))},q=require("@babel/runtime/helpers/toConsumableArray");var A=r.n(q);const T=function(){var e=(0,c.useContext)(g),t=(e.page,e.setPage),r=e.products,n=r.total,a=r.limit,l=Math.ceil(n/a);return o().createElement("div",null,o().createElement("nav",{"aria-label":"Page navigation example"},o().createElement("ul",{className:"pagination justify-content-center"},l>0&&A()(Array(l)).map((function(e,r){return o().createElement("li",{key:r,className:"page-item"},o().createElement("button",{className:"page-link",type:"button",onClick:function(){t(r+1)}},r+1))})))))},D=function(){var e=(0,c.useContext)(g),t=e.setCategory,r=e.products.categories;return o().createElement("div",{className:"form-floating-sm"},o().createElement("label",{htmlFor:"categoty"},"Filtrar por categoria: "),o().createElement("select",{className:"form-select-sm",name:"category",id:"category",onChange:function(e){e.preventDefault();var r=e.target.value;t(r)}},o().createElement("option",{value:""},"All"),r&&r.map((function(e,t){return o().createElement("option",{value:e,name:"category",key:t},e)}))))},R=function(){var e=(0,c.useContext)(g),t=e.setBrand,r=e.products.brands;return o().createElement("div",null,o().createElement("div",{className:"form-floating-sm"},o().createElement("label",{htmlFor:"brand"},"Filtrar por marca: "),o().createElement("select",{className:"form-select-sm",name:"brand",id:"brand",onChange:function(e){e.preventDefault();var r=e.target.value;t(r)}},o().createElement("option",{value:""},"All"),r&&r.map((function(e,t){return o().createElement("option",{value:e,key:t,name:e},e)})))))},I=function(){var e=(0,c.useContext)(g).setTitle;return o().createElement("header",null,o().createElement("section",{className:"container p-4 text-center"},o().createElement("div",{className:"row gx-5"},o().createElement("div",{className:"col"},o().createElement("form",{className:"d-flex",role:"search"},o().createElement("input",{className:"form-control me-2",type:"search",placeholder:"Search","aria-label":"Search",onChange:function(t){e(t.target.value)}}))),o().createElement("div",{className:"col"},o().createElement(D,null)),o().createElement("div",{className:"col"},o().createElement(R,null)))))},M=function(){return o().createElement("main",null,o().createElement(C,null,o().createElement("section",null,o().createElement("div",null,o().createElement(I,null))),o().createElement("section",null,o().createElement("div",null,o().createElement(k,null))),o().createElement("section",null,o().createElement("div",null,o().createElement(T,null)))))};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const $=function(){var e=(0,c.useState)({nombre:"",email:"",direccion:"",items:[]}),t=b()(e,2),r=t[0],n=t[1],a=(0,S.useCart)(),l=a.cartTotal,s=a.items,i=function(e){var t=e.currentTarget;n(L(L({},r),{},y()({items:s},t.name,t.value)))};return o().createElement("div",{className:"mt-2"},o().createElement("button",{type:"button",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#modalCompra","data-bs-whatever":l},"Comprar"),o().createElement("div",{className:"modal fade",id:"modalCompra",tabIndex:"-1","aria-labelledby":"modalCompraLabel","aria-hidden":"true"},o().createElement("div",{className:"modal-dialog"},o().createElement("div",{className:"modal-content"},o().createElement("div",{className:"header text-center"},o().createElement("h1",{className:"modal-title fs-5",id:"modalCompraLabel"},"Completa tus datos para pagar")),o().createElement("div",{className:"modal-body"},o().createElement("form",{action:""},o().createElement("div",{className:"mb-3"},o().createElement("label",{className:"col-form-label",htmlFor:"fullName"},"Nombre: "),o().createElement("input",{type:"text",className:"form-control",id:"fullName",name:"nombre",onChange:i})),o().createElement("div",{className:"mb-3"},o().createElement("label",{className:"col-form-label",htmlFor:"email"},"Email: "),o().createElement("input",{type:"email",className:"form-control",id:"email",name:"email",onChange:i})),o().createElement("div",{className:"mb-3"},o().createElement("label",{className:"col-form-label",htmlFor:"Direccion"},"Direccion"),o().createElement("input",{type:"text",className:"form-control",id:"Direccion",name:"direccion",onChange:i})))),o().createElement("div",{className:"modal-footer"},o().createElement("button",{type:"button",onClick:function(){n({nombre:"",email:"",direccion:"",items:[]})},className:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar"),o().createElement("button",{type:"button",onClick:function(){P().post("/api/postOrders",r).then((function(e){n({nombre:"",email:"",direccion:"",items:[]})})).catch((function(e){console.log(e)}))},className:"btn btn-primary","data-bs-dismiss":"modal"},"Pagar"))))))},F=function(){var e=(0,S.useCart)(),t=e.items,r=e.isEmpty,n=e.totalUniqueItems,a=e.totalItems,c=e.cartTotal,l=e.updateItemQuantity,s=e.removeItem,i=e.emptyCart;return r?o().createElement("div",null,o().createElement("h1",{className:"text-center"}," Carrito vacio")):o().createElement("section",{className:"py-4 container"},o().createElement("div",{className:"row justify-content-center"},o().createElement("div",{className:"col-12"},o().createElement("div",null,o().createElement("h5",null,"Carrito (",n,") con productos (",a,")")),o().createElement("table",{className:"table table-ligth table-hover m-0"},o().createElement("tbody",null,t&&t.map((function(e,t){return o().createElement("tr",{key:t},o().createElement("td",null,o().createElement("img",{src:e.image,alt:e.title,style:{height:"6rem"}})),o().createElement("td",null,e.title),o().createElement("td",null,e.price," $"),o().createElement("td",null,e.stock," "),o().createElement("td",null,"Cantidad: (",e.quantity,") unidades"),o().createElement("td",null,o().createElement("button",{className:"btn btn-info ms-2",onClick:function(){return l(e.id,e.quantity-1)}},"-"),o().createElement("button",{className:"btn btn-info ms-2",onClick:function(){return t=e.id,void((r=e.quantity)<e.stock&&r>=0&&l(t,r+1));var t,r}},"+"),o().createElement("button",{className:"btn btn-danger ms-2",onClick:function(){return s(e.id)}},"Remover producto")))}))))),o().createElement("div",{className:"col-auto ms-auto"},o().createElement("h4",null,"Total: ",c," $")),o().createElement("div",{className:"d-flex flex-row-reverse"},o().createElement("div",null,o().createElement("button",{type:"button",className:"btn btn-danger m-2",onClick:function(){return i()}},"Resetear carrito")),o().createElement($,null))))},G=function(){return o().createElement("div",null,o().createElement("div",null,o().createElement(F,null)))},B=function(){return o().createElement("div",null,o().createElement("nav",{className:"navbar bg-dark"},o().createElement("div",{className:"container-fluid"},o().createElement(j.Link,{to:"/",className:"navbar-brand text-white"},"Fast Buy"),o().createElement(j.Link,{to:"/payment",className:"navbar-brand text-white"},"Carrito"))),o().createElement(j.Routes,null,o().createElement(j.Route,{path:"/",element:o().createElement(M,null)})),o().createElement(j.Routes,null,o().createElement(j.Route,{path:"/payment",element:o().createElement(G,null)})))};var U=r(723);const Q=require("mongoose");var W=r.n(Q),Z=new Q.Schema({title:{type:String,trim:!0,required:!0},image:{type:String,trim:!0,required:!0},category:{type:String,trim:!0,required:!0},brand:{type:String,trim:!0,required:!0},stock:{type:Number,trim:!0,required:!0}});const z=(0,Q.model)("Products",Z);var X=function(){var e=d()(f().mark((function e(t,r){var n,a,c,o,l,s,i,m,u,d,p,b,v,g,E;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=parseInt(t.query.page)-1||0,a=parseInt(t.query.limit)||10,c=t.query.title||"",o=t.query.category||"",l=t.query.brand||"",s=t.query.sort||"",e.next=9,z.find();case 9:return i=e.sent,m=i.map((function(e){return e.category})),u=i.map((function(e){return e.brand})),d=m.filter((function(e,t){return m.indexOf(e)===t})),p=u.filter((function(e,t){return u.indexOf(e)===t})),b={},"asc"===s&&(b.price=1),"desc"===s&&(b.price=-1),e.next=19,z.find({title:{$regex:c,$options:"i"},brand:{$regex:l,$options:"i"},category:{$regex:o,$options:"i"}}).sort(b).skip(n*a).limit(a);case 19:return v=e.sent,e.next=22,z.countDocuments({title:{$regex:c,$options:"i"},category:{$regex:o,$options:"i"},brand:{$regex:l,$options:"i"}});case 22:g=e.sent,E={total:g,page:n+1,limit:a,categories:d,brands:p,products:v},r.status(200).json(E),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(0),r.status(500).json({message:e.t0.message});case 30:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t,r){return e.apply(this,arguments)}}(),Y=(0,e.Router)();Y.get("/products",X);const K=Y;var V=new Q.Schema({priceTotal:{type:Number,required:!0},user:{type:String,require:!0},product:{type:Array,require:!0},totalProducts:{type:Number},status:{type:String,required:!0}});(0,Q.model)("Orders",V),r(689);var H=r(184),J=r(723),ee=J.EMAIL_APP,te=J.PASSWORD_APP,re=function(){var e=d()(f().mark((function e(t,r,n,a){var c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=H.createTransport({host:"smtp.gmail.com",auth:{user:ee,pass:te}}),e.next=3,c.sendMail({from:"Pago exitoso <fleamarket.appservices@gmail.com>",to:t,subject:"Su pago se ha registrado correctamente",text:"Se le informa que ha realizado la compra de sus productos y se procedera con el envio de los productos",html:"<div><h3>Pago exitoso</h3><p>El usuario ".concat(r," ha realizado una compra en Fast Buy y muy pronto sera enviado a su domicilio ").concat(a," </p></div>")});case 3:e.sent,console.log("message send");case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),ne=function(){var e=d()(f().mark((function e(t,r){var n,a,c,o,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.body,a=n.nombre,c=n.email,o=n.direccion,l=n.items,a&&c&&o&&l){e.next=6;break}return e.abrupt("return",r.status(404).json({message:"No se ha comprado ningun elemento"}));case 6:re(c,a,l,o),r.status(200).json({message:"Tu pago se ha realizado"});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),r.status(500).json({message:e.t0.message}),console.log(e.t0.message,e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}(),ae=(0,e.Router)();ae.post("/postOrders",ne);const ce=ae;var oe=t()();oe.set("port",U.PORT),oe.use(m()("dev")),oe.use(a()()),oe.use(t().static("public")),oe.use(t().json({limit:52428800,extended:!0})),oe.use(t().urlencoded({limit:52428800,extended:!0})),oe.use((function(e,t,r){t.header("Access-Control-Allow-Origin",U.DOMINIO),t.header("Access-Control-Allow-Credentials","true"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),t.header("Access-Control-Allow-Methods","GET, POST, OPTIONS, PUT, DELETE"),r()})),oe.use("/api",K),oe.use("/api",ce),oe.get("*",(function(e,t,r){var n=(0,s.renderToString)(o().createElement(l.StaticRouter,{location:e.url,context:{}},o().createElement(B,null)));t.send('\n\t\t<!DOCTYPE html>\n\t\t<html>\n\t\t    <head>\n\t\t    \t<meta charset="utf-8">\n    \t\t\t<meta name="viewport" content="width=device-width, initial-scale=1">\n\t\t       \t<title>Fast Buy</title>\n\t\t       \t<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">\n\t\t    </head>\n\t\t    <body>\n\t\t    \t\t<script src="/modalBuy.js" defer><\/script>\n\t\t       \t<script src="/bundle.js" defer><\/script>\n\t\t    \t\t<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"><\/script>\n\t\t\t\t\t\t<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"><\/script>\n\t\t    \t\t<div id="root" >'.concat(n,"</div>\n\t\t    </body>\n\t\t</html>\n\t\t"))}));const le=oe;!function(){var e=d()(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W().set("strictQuery",!1);case 2:return e.next=4,W().connect(U.MONGO_URL);case 4:t=e.sent,console.log("Using Mongo DB version ".concat(t.version," in the port ").concat(t.connection.port));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),le.listen(le.get("port"),(function(){console.log("Server is listening on port: ".concat(le.get("port")))}))})()})();